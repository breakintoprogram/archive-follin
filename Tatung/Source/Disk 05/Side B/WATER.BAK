ORG 50000
LOAD 49152

CONT:EQU 65533
DATA:EQU 49149

LD A,64
LD (FIL),A
LD HL,1100
LD (BT1),HL
RET

WATER:LD A,(FIL)
DEC A
RET Z
LD (FIL),A
DEC A
JP Z,WINI
LD BC,CONT
LD A,6
OUT (C),A
LD BC,DATA
LD A,(FIL)
SRL A
DEC A
OUT (C),A
LD BC,CONT
LD A,10
OUT (C),A
LD BC,DATA
LD A,12
OUT (C),A
LD BC,CONT
LD A,4
OUT (C),A
LD BC,DATA
LD A,(BT1)
OUT (C),A
LD BC,CONT
LD A,5
OUT (C),A
LD BC,DATA
LD A,(BT2)
OUT (C),A
LD BC,CONT
LD A,7
OUT (C),A
LD BC,DATA
LD A,(BYTE)
RES 5,A
RES 2,A
OUT (C),A
LD BC,18
LD HL,(BT1)
OR A
SBC HL,BC
LD (BT1),HL
RET

WINI:LD BC,CONT
LD A,7
OUT (C),A
LD BC,DATA
LD A,(BYTE)
SET 5,A
SET 2,A
OUT (C),A
RET

FIL:DB 0
BYTE:DB 63
BT1:DB 0
BT2:DB 0

END
